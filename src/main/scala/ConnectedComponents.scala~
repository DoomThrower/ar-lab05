import org.apache.spark._
import org.apache.spark.graphx._
import org.apache.spark.graphx.lib._
import org.apache.spark.graphx.PartitionStrategy._


/** Connected components algorithm. */
object ConnectedComponents {
	def main(args: Array[String]) {
		if (args.length < 1) {
			System.err.println("Usage: ConnectedComponents <file>")
			System.exit(1)
		}
		val fname = args(1)

		val conf = new SparkConf()
		val sc = new SparkContext(conf.setAppName("ConnectedComponents(" + fname + ")"))
		
		// Load the graph
		val graph = GraphLoader.edgeListFile(sc, args(0))
		//val graph = partitionStrategy.foldLeft(unpartitionedGraph)(_.partitionBy(_))

		val cc = ConnectedComponents.run(graph)
        println("Components: " + cc.vertices.map { case (vid, data) => data }.distinct())
        sc.stop()
	}
}
